bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "00" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "01" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "02" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "03" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "04" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "05" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "06" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "07" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "08" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "09" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "0b" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "0c" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "0d" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "0e" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "0f" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "0g" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "0h" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "0j" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "0k" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "0m" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "0n" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "0p" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "0q" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "0r" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "0s" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "0t" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "0u" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "0v" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "0w" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "0x" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "0y" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "0z" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "10" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "11" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "12" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "13" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "14" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "15" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "16" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "17" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "18" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "19" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "1b" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "1c" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "1d" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "1e" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "1f" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "1g" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "1h" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "1j" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "1k" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "1m" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "1n" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "1p" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "1q" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "1r" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "1s" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "1t" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "1u" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "1v" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "1w" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "1x" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "1y" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "1z" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "20" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "21" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "22" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "23" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "24" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "25" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "26" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "27" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "28" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "29" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "2b" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "2c" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "2d" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "2e" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "2f" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "2g" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "2h" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "2j" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "2k" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "2m" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "2n" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "2p" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "2q" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "2r" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "2s" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "2t" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "2u" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "2v" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "2w" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "2x" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "2y" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "2z" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "30" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "31" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "32" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "33" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "34" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "35" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "36" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "37" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "38" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "39" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "3b" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "3c" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "3d" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "3e" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "3f" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "3g" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "3h" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "3j" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "3k" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "3m" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "3n" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "3p" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "3q" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "3r" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "3s" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "3t" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "3u" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "3v" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "3w" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "3x" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "3y" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "3z" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "40" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "41" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "42" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "43" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "44" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "45" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "46" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "47" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "48" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "49" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "4b" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "4c" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "4d" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "4e" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "4f" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "4g" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "4h" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "4j" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "4k" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "4m" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "4n" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "4p" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "4q" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "4r" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "4s" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "4t" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "4u" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "4v" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "4w" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "4x" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "4y" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "4z" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "50" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "51" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "52" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "53" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "54" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "55" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "56" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "57" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "58" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "59" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "5b" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "5c" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "5d" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "5e" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "5f" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "5g" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "5h" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "5j" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "5k" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "5m" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "5n" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "5p" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "5q" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "5r" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "5s" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "5t" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "5u" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "5v" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "5w" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "5x" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "5y" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "5z" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "60" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "61" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "62" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "63" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "64" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "65" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "66" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "67" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "68" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "69" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "6b" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "6c" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "6d" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "6e" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "6f" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "6g" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "6h" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "6j" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "6k" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "6m" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "6n" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "6p" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "6q" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "6r" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "6s" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "6t" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "6u" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "6v" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "6w" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "6x" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "6y" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "6z" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "70" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "71" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "72" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "73" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "74" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "75" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "76" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "77" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "78" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "79" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "7b" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "7c" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "7d" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "7e" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "7f" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "7g" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "7h" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "7j" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "7k" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "7m" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "7n" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "7p" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "7q" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "7r" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "7s" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "7t" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "7u" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "7v" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "7w" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "7x" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "7y" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "7z" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "80" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "81" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "82" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "83" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "84" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "85" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "86" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "87" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "88" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "89" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "8b" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "8c" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "8d" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "8e" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "8f" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "8g" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "8h" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "8j" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "8k" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "8m" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "8n" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "8p" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "8q" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "8r" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "8s" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "8t" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "8u" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "8v" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "8w" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "8x" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "8y" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "8z" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "90" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "91" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "92" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "93" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "94" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "95" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "96" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "97" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "98" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "99" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "9b" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "9c" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "9d" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "9e" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "9f" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "9g" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "9h" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "9j" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "9k" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "9m" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "9n" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "9p" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "9q" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "9r" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "9s" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "9t" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "9u" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "9v" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "9w" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "9x" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "9y" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "9z" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "b0" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "b1" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "b2" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "b3" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "b4" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "b5" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "b6" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "b7" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "b8" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "b9" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "bb" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "bc" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "bd" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "be" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "bf" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "bg" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "bh" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "bj" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "bk" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "bm" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "bn" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "bp" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "bq" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "br" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "bs" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "bt" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "bu" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "bv" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "bw" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "bx" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "by" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "bz" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "c0" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "c1" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "c2" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "c3" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "c4" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "c5" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "c6" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "c7" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "c8" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "c9" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "cb" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "cc" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "cd" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "ce" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "cf" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "cg" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "ch" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "cj" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "ck" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "cm" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "cn" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "cp" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "cq" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "cr" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "cs" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "ct" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "cu" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "cv" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "cw" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "cx" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "cy" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "cz" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "d0" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "d1" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "d2" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "d3" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "d4" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "d5" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "d6" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "d7" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "d8" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "d9" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "db" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "dc" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "dd" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "de" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "df" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "dg" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "dh" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "dj" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "dk" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "dm" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "dn" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "dp" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "dq" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "dr" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "ds" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "dt" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "du" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "dv" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "dw" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "dx" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "dy" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "dz" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "e0" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "e1" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "e2" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "e3" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "e4" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "e5" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "e6" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "e7" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "e8" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "e9" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "eb" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "ec" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "ed" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "ee" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "ef" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "eg" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "eh" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "ej" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "ek" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "em" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "en" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "ep" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "eq" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "er" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "es" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "et" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "eu" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "ev" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "ew" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "ex" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "ey" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "ez" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "f0" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "f1" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "f2" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "f3" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "f4" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "f5" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "f6" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "f7" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "f8" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "f9" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "fb" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "fc" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "fd" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "fe" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "ff" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "fg" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "fh" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "fj" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "fk" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "fm" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "fn" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "fp" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "fq" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "fr" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "fs" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "ft" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "fu" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "fv" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "fw" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "fx" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "fy" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "fz" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "g0" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "g1" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "g2" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "g3" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "g4" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "g5" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "g6" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "g7" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "g8" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "g9" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "gb" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "gc" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "gd" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "ge" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "gf" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "gg" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "gh" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "gj" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "gk" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "gm" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "gn" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "gp" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "gq" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "gr" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "gs" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "gt" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "gu" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "gv" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "gw" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "gx" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "gy" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "gz" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "h0" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "h1" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "h2" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "h3" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "h4" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "h5" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "h6" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "h7" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "h8" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "h9" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "hb" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "hc" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "hd" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "he" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "hf" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "hg" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "hh" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "hj" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "hk" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "hm" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "hn" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "hp" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "hq" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "hr" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "hs" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "ht" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "hu" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "hv" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "hw" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "hx" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "hy" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "hz" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "j0" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "j1" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "j2" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "j3" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "j4" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "j5" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "j6" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "j7" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "j8" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "j9" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "jb" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "jc" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "jd" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "je" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "jf" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "jg" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "jh" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "jj" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "jk" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "jm" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "jn" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "jp" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "jq" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "jr" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "js" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "jt" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "ju" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "jv" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "jw" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "jx" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "jy" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "jz" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "k0" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "k1" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "k2" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "k3" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "k4" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "k5" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "k6" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "k7" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "k8" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "k9" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "kb" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "kc" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "kd" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "ke" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "kf" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "kg" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "kh" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "kj" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "kk" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "km" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "kn" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "kp" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "kq" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "kr" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "ks" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "kt" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "ku" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "kv" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "kw" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "kx" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "ky" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "kz" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "m0" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "m1" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "m2" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "m3" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "m4" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "m5" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "m6" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "m7" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "m8" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "m9" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "mb" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "mc" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "md" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "me" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "mf" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "mg" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "mh" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "mj" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "mk" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "mm" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "mn" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "mp" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "mq" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "mr" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "ms" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "mt" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "mu" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "mv" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "mw" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "mx" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "my" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "mz" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "n0" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "n1" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "n2" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "n3" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "n4" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "n5" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "n6" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "n7" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "n8" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "n9" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "nb" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "nc" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "nd" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "ne" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "nf" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "ng" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "nh" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "nj" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "nk" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "nm" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "nn" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "np" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "nq" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "nr" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "ns" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "nt" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "nu" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "nv" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "nw" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "nx" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "ny" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "nz" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "p0" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "p1" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "p2" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "p3" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "p4" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "p5" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "p6" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "p7" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "p8" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "p9" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "pb" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "pc" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "pd" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "pe" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "pf" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "pg" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "ph" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "pj" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "pk" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "pm" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "pn" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "pp" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "pq" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "pr" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "ps" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "pt" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "pu" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "pv" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "pw" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "px" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "py" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "pz" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "q0" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "q1" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "q2" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "q3" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "q4" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "q5" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "q6" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "q7" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "q8" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "q9" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "qb" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "qc" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "qd" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "qe" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "qf" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "qg" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "qh" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "qj" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "qk" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "qm" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "qn" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "qp" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "qq" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "qr" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "qs" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "qt" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "qu" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "qv" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "qw" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "qx" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "qy" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "qz" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "r0" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "r1" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "r2" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "r3" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "r4" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "r5" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "r6" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "r7" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "r8" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "r9" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "rb" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "rc" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "rd" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "re" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "rf" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "rg" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "rh" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "rj" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "rk" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "rm" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "rn" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "rp" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "rq" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "rr" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "rs" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "rt" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "ru" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "rv" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "rw" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "rx" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "ry" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "rz" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "s0" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "s1" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "s2" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "s3" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "s4" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "s5" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "s6" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "s7" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "s8" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "s9" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "sb" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "sc" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "sd" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "se" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "sf" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "sg" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "sh" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "sj" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "sk" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "sm" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "sn" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "sp" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "sq" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "sr" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "ss" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "st" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "su" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "sv" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "sw" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "sx" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "sy" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "sz" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "t0" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "t1" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "t2" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "t3" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "t4" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "t5" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "t6" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "t7" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "t8" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "t9" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "tb" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "tc" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "td" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "te" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "tf" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "tg" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "th" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "tj" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "tk" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "tm" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "tn" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "tp" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "tq" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "tr" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "ts" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "tt" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "tu" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "tv" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "tw" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "tx" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "ty" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "tz" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "u0" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "u1" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "u2" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "u3" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "u4" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "u5" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "u6" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "u7" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "u8" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "u9" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "ub" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "uc" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "ud" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "ue" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "uf" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "ug" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "uh" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "uj" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "uk" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "um" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "un" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "up" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "uq" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "ur" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "us" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "ut" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "uu" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "uv" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "uw" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "ux" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "uy" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "uz" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "v0" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "v1" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "v2" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "v3" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "v4" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "v5" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "v6" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "v7" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "v8" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "v9" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "vb" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "vc" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "vd" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "ve" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "vf" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "vg" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "vh" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "vj" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "vk" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "vm" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "vn" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "vp" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "vq" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "vr" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "vs" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "vt" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "vu" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "vv" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "vw" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "vx" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "vy" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "vz" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "w0" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "w1" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "w2" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "w3" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "w4" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "w5" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "w6" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "w7" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "w8" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "w9" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "wb" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "wc" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "wd" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "we" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "wf" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "wg" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "wh" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "wj" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "wk" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "wm" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "wn" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "wp" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "wq" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "wr" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "ws" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "wt" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "wu" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "wv" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "ww" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "wx" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "wy" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "wz" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "x0" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "x1" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "x2" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "x3" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "x4" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "x5" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "x6" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "x7" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "x8" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "x9" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "xb" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "xc" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "xd" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "xe" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "xf" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "xg" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "xh" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "xj" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "xk" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "xm" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "xn" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "xp" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "xq" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "xr" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "xs" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "xt" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "xu" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "xv" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "xw" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "xx" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "xy" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "xz" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "y0" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "y1" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "y2" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "y3" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "y4" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "y5" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "y6" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "y7" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "y8" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "y9" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "yb" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "yc" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "yd" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "ye" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "yf" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "yg" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "yh" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "yj" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "yk" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "ym" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "yn" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "yp" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "yq" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "yr" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "ys" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "yt" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "yu" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "yv" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "yw" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "yx" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "yy" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "yz" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "z0" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "z1" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "z2" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "z3" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "z4" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "z5" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "z6" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "z7" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "z8" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "z9" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "zb" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "zc" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "zd" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "ze" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "zf" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "zg" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "zh" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "zj" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "zk" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "zm" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "zn" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "zp" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "zq" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "zr" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "zs" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "zt" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "zu" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "zv" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "zw" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "zx" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "zy" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
bq query --batch --append_table --destination_table gcp-pdp-osm-dev:geohash_v1.level_7_vectors_tfidf --nosynchronous_mode --nouse_legacy_sql ' WITH data AS ( SELECT   * FROM `gcp-pdp-osm-dev.geohash_v1.level_7_terms_partitioned` WHERE SUBSTR(geohash, 1, 2) = "zz" ) ,features_matrix AS ( SELECT geohash, CONCAT(gf.layer_code, "_", gf.layer_class, "_", gf.layer_name) as word FROM `gcp-pdp-osm-dev.geofabrik.layers` gf CROSS JOIN (SELECT geohash FROM data GROUP BY geohash) ORDER BY geohash, word ) SELECT   fm.geohash as geohash, ARRAY_AGG(IFNULL(tf_idf.tfidf, 0.0) ORDER BY fm.word) as tfidf_vec FROM features_matrix fm LEFT JOIN `gcp-pdp-osm-dev.geohash_v1.level_7_vectors_tfidf_raw` tf_idf ON tf_idf.term = fm.word AND tf_idf.geohash = fm.geohash GROUP BY geohash '
