dataset:
  name: geo-openstreetmap

  friendly_name: ~
  description: ~
  dataset_sources: ~
  terms_of_use: ~

dag:
  initialize:
    dag_id: transferring_src_osm_file
    default_args:
      owner: "geo-openstreetmap"
      depends_on_past: False
      start_date: '2021-06-01'
    max_active_runs: 1
    schedule_interval: "@weekly"
    catchup: False
    default_view: graph

  tasks:
    - operator: "BigQueryToBigQueryOperator"
      description: "Task to run a BQ to BQ operation"

      args:
        task_id: ["{{ var.json.geo_openstreetmap.transfer_src_planet.project_id }}"]
        source_project_dataset_tables: ["{{ var.json.geo_openstreetmap.transfer_src_planet.source_project_dataset_table }}"]
        destination_project_dataset_table: "{{ var.json.geo_openstreetmap.transfer_src_planet.destination_project_dataset_table }}"
        impersonation_chain: "{{ var.geo_openstreetmap.service_account }}"
        write_disposition: "WRITE_TRUNCATE"



